---
name: push-usage-service
release: push-usage-service-release
provides: |
  app-usage-internal: {as: app-usage-internal}
manifest: |
  cf:
    api_url: "https://api.(( .cloud_controller.system_domain.value ))"
    uaa_url: "https://login.(( .cloud_controller.system_domain.value ))"
    notifications_service_url: "https://notifications.(( .cloud_controller.system_domain.value ))"
    system_domain: (( .cloud_controller.system_domain.value ))
    apps_domain: (( .cloud_controller.apps_domain.value ))
    push_client_id: (( .uaa.push_usage_service_client_credentials.identity ))
    push_client_secret: (( .uaa.push_usage_service_client_credentials.password ))
  app_usage_service:
    url: "https://app-usage.(( .cloud_controller.system_domain.value ))"
    uaa_client_id: (( .uaa.usage_service_client_credentials.identity ))
    uaa_client_secret: (( .uaa.usage_service_client_credentials.password ))
    rails_secret_token: ((( push-usage-service-secret-token )))
    cutoff_age_in_days: (( .properties.push_usage_service_cutoff_age_in_days.value ))
  databases:
    app_usage_service: (( .properties.system_database.selected_option.parsed_manifest(push-app-usage-service) ))
  ssl:
    skip_cert_verify: (( .ha_proxy.skip_cert_verify.value ))
    disable_http_for_links: (( .properties.routing_disable_http.value ))
