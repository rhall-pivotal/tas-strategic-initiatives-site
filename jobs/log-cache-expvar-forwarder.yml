---
name: log-cache-expvar-forwarder
release: log-cache
manifest: |
  loggregator_agent:
    tls:
      ca_cert: (( $ops_manager.ca_certificate ))
      cert: (( .properties.log_cache_expvar_forwarder_client_tls_cert.cert_pem ))
      key: (( .properties.log_cache_expvar_forwarder_client_tls_cert.private_key_pem ))
  counters:
  - addr: http://localhost:6060/debug/vars
    name: egress
    source_id: log-cache
    template: '{{`{{.LogCache.Egress}}`}}'
  - addr: http://localhost:6060/debug/vars
    name: ingress
    source_id: log-cache
    template: '{{`{{.LogCache.Ingress}}`}}'
  - addr: http://localhost:6060/debug/vars
    name: expired
    source_id: log-cache
    template: '{{`{{.LogCache.Expired}}`}}'
  - addr: http://localhost:6061/debug/vars
    name: egress
    source_id: log-cache-nozzle
    template: '{{`{{.Nozzle.Egress}}`}}'
  - addr: http://localhost:6061/debug/vars
    name: ingress
    source_id: log-cache-nozzle
    template: '{{`{{.Nozzle.Ingress}}`}}'
  - addr: http://localhost:6061/debug/vars
    name: err
    source_id: log-cache-nozzle
    template: '{{`{{.Nozzle.Err}}`}}'
  gauges:
  - addr: http://localhost:6060/debug/vars
    name: cache-period
    source_id: log-cache
    template: '{{`{{.LogCache.CachePeriod}}`}}'
  - addr: http://localhost:6060/debug/vars
    name: store-size
    source_id: log-cache
    template: '{{`{{.LogCache.StoreSize}}`}}'
  - addr: http://localhost:6060/debug/vars
    name: total-system-memory
    source_id: log-cache
    template: '{{`{{.LogCache.TotalSystemMemory}}`}}'
  - addr: http://localhost:6060/debug/vars
    name: available-system-memory
    source_id: log-cache
    template: '{{`{{.LogCache.AvailableSystemMemory}}`}}'
