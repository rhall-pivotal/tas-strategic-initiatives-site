---
name: rep
release: diego
manifest: |
  diego:
    rep:
      bbs:
        ca_cert: (( $ops_manager.ca_certificate ))
        client_cert: (( .properties.bbs_client_cert.cert_pem ))
        client_key: (( .properties.bbs_client_cert.private_key_pem ))
      ca_cert: (( $ops_manager.ca_certificate ))
      enable_legacy_api_endpoints: false
      locket:
        api_location: locket.service.cf.internal:8891
      preloaded_rootfses: '(( .properties.enable_grootfs.value ? .properties.rep_preloaded_rootfses_grootfs.value : .properties.rep_preloaded_rootfses_garden.value ))'
      require_tls: true
      server_cert: (( .properties.rep_server_cert.cert_pem ))
      server_key: (( .properties.rep_server_cert.private_key_pem ))
      trusted_certs: |
        ((( /cf/diego-instance-identity-root-ca.certificate )))
        (( $ops_manager.ca_certificate ))
        (( $ops_manager.trusted_certificates ))
      use_azure_fault_domains: true
    executor:
      ca_certs_for_downloads: (( $ops_manager.ca_certificate ))
      disk_capacity_mb: (( .diego_cell.executor_disk_capacity.value ))
      instance_identity_ca_cert: ((( /cf/diego-instance-identity-intermediate-ca.certificate )))
      instance_identity_key: ((( /cf/diego-instance-identity-intermediate-ca.private_key )))
      memory_capacity_mb: (( .diego_cell.executor_memory_capacity.value ))
      post_setup_hook: sh -c "rm -f /home/vcap/app/.java-buildpack.log /home/vcap/app/**/.java-buildpack.log"
      post_setup_user: root
  loggregator:
    use_v2_api: true
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.loggregator_client_cert.cert_pem ))
    key: (( .properties.loggregator_client_cert.private_key_pem ))
  tls:
    ca_cert: (( $ops_manager.ca_certificate ))
    cert: (( .properties.rep_server_cert.cert_pem ))
    key: (( .properties.rep_server_cert.private_key_pem ))
